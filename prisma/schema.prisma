generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model City {
  slug         String  @id
  name         String
  country      String
  image        String
  population   Int
  temperatureC Decimal @db.Decimal(4, 1)
  latitude     Decimal @db.Decimal(9, 6)
  longitude    Decimal @db.Decimal(9, 6)
  region       String

  // descriptionFromReview     String? 
  // shortSlug                 String
  // usersCount                Int
  // usersCountEst             Int
  // usersCountBeen            Int
  // usersCountBeenEst         Int
  // boost                     Float?
  // last2YearGrowth           Decimal @db.Decimal
  // weatherIcon               String

  nameChinese    String
  countryChinese String
  airQualityNow  Int
  airQuality     Float?
  countryCode    String
  countrySlug    String
  stateCode      String?
  stateChinese   String?
  state          String?

  internetSpeed               Int
  internetScoreDigitalNomad   Decimal @db.Decimal
  internetSpeedDigitalNomad   Int
  internetSpeedCity           Int
  internetSpeedCityRanking    Int
  internetSpeedCountry        Int
  internetSpeedCountryRanking Int

  airQualityScore       Int
  airQualityNowScore    Decimal @db.Decimal
  humidity              String
  rank                  Int
  // weatherEmoji              String
  temperatureF          Decimal @db.Decimal
  temperatureCFeelsLike Decimal @db.Decimal
  temperatureFFeelsLike Decimal @db.Decimal
  costForNomadInUsd     Decimal @db.Decimal
  costForExpatInUsd     Decimal @db.Decimal
  costForLocalInUsd     Decimal @db.Decimal
  costForFamilyInUsd    Decimal @db.Decimal
  totalScore            Decimal @db.Decimal
  overallScore          Decimal @db.Decimal
  costScore             Int
  likesScore            Decimal @db.Decimal
  safetyLevel           Decimal @db.Decimal

  isWeather2024Collected Boolean @default(false)

  weathers        Weather[]        @relation("cityWeather")
  weathersAverage WeatherAverage[] @relation("cityWeatherAverage")
}

model Weather {
  id                       Int      @id @default(autoincrement())
  date                     DateTime
  weatherCode              Int
  apparentTemperatureMax   Decimal
  rainSum                  Decimal
  windGusts10mMax          Decimal
  snowfallSum              Decimal
  windDirection10mDominant Decimal
  daylightDuration         Decimal
  apparentTemperatureMin   Decimal
  temperature2mMax         Decimal
  temperature2mMin         Decimal
  apparentTemperatureMean  Decimal
  sunshineDuration         Decimal
  precipitationHours       Decimal
  shortwaveRadiationSum    Decimal
  windSpeed10mMax          Decimal
  precipitationSum         Decimal
  temperature2mMean        Decimal

  citySlug String
  city     City   @relation("cityWeather", fields: [citySlug], references: [slug], onDelete: Cascade)

  @@unique([citySlug, date])
}

enum WeatherIcon {
  SUN
  CLOUDY
  WIND
  RAIN
  SNOW
  NULL
}

model WeatherAverage {
  id                       Int         @id @default(autoincrement())
  month                    String      @db.VarChar(2)
  weatherCode              Int
  apparentTemperatureMax   Decimal
  rainSum                  Decimal
  windGusts10mMax          Decimal
  snowfallSum              Decimal
  windDirection10mDominant Decimal
  daylightDuration         Decimal
  apparentTemperatureMin   Decimal
  temperature2mMax         Decimal
  temperature2mMin         Decimal
  apparentTemperatureMean  Decimal
  sunshineDuration         Decimal
  precipitationHours       Decimal
  shortwaveRadiationSum    Decimal
  windSpeed10mMax          Decimal
  precipitationSum         Decimal
  temperature2mMean        Decimal
  weatherIcon              WeatherIcon @default(NULL)

  citySlug String
  city     City   @relation("cityWeatherAverage", fields: [citySlug], references: [slug], onDelete: Cascade)

  @@unique([citySlug, month])
  @@index([citySlug, month])
}
